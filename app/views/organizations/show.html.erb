<script type="text/javascript">
  var app = "<%= @locations.first.state.to_json %>"
  var app1 = "<%= @loca.to_json %>"
  var heyy = "<%= @hey%>"
  var loca = "<%= @loca %>"
</script>

<script src="//maps.google.com/maps/api/js?key=AIzaSyAWkRro3MZ573WfwljtHFkYD6XWyxAv-Lg"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->

<div class="container org-show">
  <h1><%= @organization.name %></h1>
  <br>
  <div class="panel">
    <h2>Who We Are</h2>
    <h2><%= @organization.bio %></h2>
    <br>
    <div>
      <h2>Our Locations Around The World</h2>
      <% @organization.locations.each do |orgloc| %>
        <h3>Country: <%= orgloc.country %></h3>
        <h3>State: <%= orgloc.state %></h3>
        <h3>City: <%= orgloc.city %></h3>
      <% end %>
    </div>
    <br>
    <% if current_user %>
      Email: <a href="mailto: <%= @organization.email%>"><%= @organization.email %></a>
      <br>
      Phone: <%= @organization.phone %>
    <% else %>
      <%= button_to "Sign In To Contact Us", login_path, { method: :get, params: {redirect_back: organization_path(@organization)} } %>
    <% end %>
  </div>

  <div style='width: 800px;'>
    <div id="map" style='width: 800px; height: 400px;'></div>
  </div> 

  <script type="text/javascript">
  
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    var geocoder =  new google.maps.Geocoder();
      geocoder.geocode( { 'address': loca}, function(results, status) {
        r1 = results[0].geometry.location.lat();
        r2 = results[0].geometry.location.lng();

      // markers = handler.addMarkers(<%=raw @hey.to_json %>);
      markers = handler.addMarkers([{"lat":r1,"lng":r2}]);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(5);
      });
    });
  </script> 
  <!-- <div id="map"></div> -->

<br>

</div>
<br>
<br>
